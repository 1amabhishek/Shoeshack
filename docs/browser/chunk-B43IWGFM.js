import{a as Ve,b as wt,c as xt,d as yt}from"./chunk-GTD7GOE7.js";import{a as vt}from"./chunk-GRD75GYV.js";import{a as x}from"./chunk-ZQRFGBOX.js";import{$ as it,A as N,Aa as ke,B as Ce,Ba as qe,C as ve,D as u,Da as Ae,E as we,F as xe,G as ye,H as h,Ia as Ct,J as Ee,K as be,L as Ue,N as Xe,O as Ye,P as et,Q as tt,T as rt,V as Ie,W as Se,X as De,Y as Te,Z as Ne,_ as Pe,ba as ot,i as je,ia as Me,ka as at,la as nt,ma as lt,na as mt,oa as st,pa as pt,q as ge,qa as ct,r as L,ra as dt,s as he,sa as ut,t as Ke,ta as ft,u as F,ua as _t,v as R,va as gt,w as O,wa as ht,y as D,z as T}from"./chunk-ZU2ZXMGP.js";import{$a as v,A as Qe,Ab as k,Bb as q,Cb as o,Db as r,Eb as c,Fb as P,Gb as M,Ib as A,Lb as g,N as ce,Nb as w,Pc as V,Qb as _e,Sb as Fe,Tb as Re,Tc as Ze,Ub as Oe,Wa as fe,Wb as a,Xb as E,Yb as b,Zb as We,_a as n,ca as de,d as Be,dc as Je,ma as U,na as ue,rb as f,t as He,tb as l,va as I,wa as S}from"./chunk-RJHPHPNE.js";var Et=(()=>{let t=class t{constructor(p,m){this.dialogRef=p,this.data=m}closeDialog(){this.dialogRef.close()}deleteUser(){this.dialogRef.close(this.data)}};t.\u0275fac=function(m){return new(m||t)(v(L),v(he))},t.\u0275cmp=U({type:t,selectors:[["app-delete-user-dialog"]],decls:23,vars:2,consts:[["mat-dialog-title","",1,"mat-dialog-title"],["svgIcon","account",1,"mr-2"],[1,"flex-spacer"],["mat-icon-button","",3,"click"],["svgIcon","close"],[1,"text-center","pt-2"],["svgIcon","message-alert","color","warn",1,"icon-lg"],[1,"text-center"],[1,"text-warn"],[1,"text-muted"],["align","end",1,"mat-dialog-actions"],["mat-button","","color","basic",3,"click"],["mat-flat-button","","color","primary",3,"click"],["svgIcon","delete"]],template:function(m,i){m&1&&(o(0,"h2",0),c(1,"mat-icon",1),a(2," Delete user "),c(3,"div",2),o(4,"button",3),g("click",function(){return i.closeDialog()}),c(5,"mat-icon",4),r()(),o(6,"mat-dialog-content")(7,"p",5),c(8,"mat-icon",6),r(),o(9,"p",7),a(10," Are you sure you want to delete the user "),o(11,"span",8),a(12),r(),a(13,"? "),o(14,"span",9),a(15),r()()(),o(16,"mat-dialog-actions",10)(17,"button",11),g("click",function(){return i.closeDialog()}),c(18,"mat-icon",4),a(19," Cancel "),r(),o(20,"button",12),g("click",function(){return i.deleteUser()}),c(21,"mat-icon",13),a(22," Eliminate "),r()()),m&2&&(n(12),E(i.data.profile.firstName+" "+i.data.profile.lastName),n(3),b("(",i.data.user.email,")"))},dependencies:[D,T,N,F,O,R]});let e=t;return e})();var Le=["Admin","User"];var At=(e,t)=>t.value,Vt=(e,t)=>t.code;function Lt(e,t){e&1&&(o(0,"mat-error",33),a(1," Email is required "),r())}function Ft(e,t){e&1&&(o(0,"mat-error",33),a(1," The email is not valid "),r())}function Rt(e,t){e&1&&(o(0,"mat-error",33),a(1," The email must have a maximum of 320 characters "),r())}function Ot(e,t){if(e&1&&(o(0,"mat-option",11),a(1),r()),e&2){let d=t.$implicit;l("value",d.value),n(),E(d.label)}}function jt(e,t){e&1&&(o(0,"mat-error",33),a(1," The role is required "),r())}function $t(e,t){e&1&&(o(0,"mat-error",33),a(1," Password is requiredPassword is required "),r())}function Gt(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must be at least 10 characters "),r())}function zt(e,t){e&1&&(o(0,"mat-error",33),a(1," The password must have a maximum of 100 characters "),r())}function Bt(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one number "),r())}function Ht(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one uppercase letter "),r())}function Qt(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one lowercase letter "),r())}function Wt(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one special character "),r())}function Jt(e,t){e&1&&(o(0,"mat-error",33),a(1," Confirmation is required "),r())}function Zt(e,t){e&1&&(o(0,"mat-error",33),a(1," Confirmation must match password "),r())}function Kt(e,t){e&1&&(o(0,"mat-error",33),a(1," The name is required "),r())}function Xt(e,t){e&1&&(o(0,"mat-error",33),a(1," The name must be at least 3 characters "),r())}function Yt(e,t){e&1&&(o(0,"mat-error",33),a(1," Name must be less than 50 characters "),r())}function er(e,t){e&1&&(o(0,"mat-error",33),a(1," Last name is required "),r())}function tr(e,t){e&1&&(o(0,"mat-error",33),a(1," Last name must be at least 3 characters "),r())}function rr(e,t){e&1&&(o(0,"mat-error",33),a(1," Last name must be less than 50 characters "),r())}function ir(e,t){if(e&1&&(o(0,"mat-option",11),c(1,"img",34),o(2,"span",35),a(3),r()()),e&2){let d=t.$implicit;l("value",d),n(),_e("src","https://flagsapi.com/",d.code,"/flat/24.png",fe),l("alt",d.code),n(2),b(" ",d.name," ")}}function or(e,t){e&1&&(o(0,"mat-error",33),a(1," The country is required "),r())}function ar(e,t){e&1&&(o(0,"mat-error",33),a(1," Phone number is required "),r())}function nr(e,t){e&1&&(o(0,"mat-error",33),a(1," The phone number is invalid "),r())}function lr(e,t){e&1&&(o(0,"mat-error",33),a(1," Address is required "),r())}function mr(e,t){e&1&&(o(0,"mat-error",33),a(1," Address must be at least 10 characters "),r())}function sr(e,t){e&1&&(o(0,"mat-error",33),a(1," Address must be less than 500 characters "),r())}var Ut=(()=>{let t=class t{constructor(p){this.dialogRef=p,this.form=new ye({email:new h("",[u.required,u.email,u.maxLength(320)]),password:new h("",[u.required,u.minLength(10),u.maxLength(100),x.hasLowercase(),x.hasUppercase(),x.hasNumber(),x.hasSpecialCharacter()]),confirmPassword:new h("",[u.required]),role:new h("User",[u.required]),firstName:new h("",[u.required,u.minLength(3),u.maxLength(50)]),lastName:new h("",[u.required,u.minLength(3),u.maxLength(50)]),country:new h(null,[u.required]),phoneNumber:new h("",[u.required,x.phoneNumberWithAreaCode()]),address:new h("",[u.required,u.minLength(10),u.maxLength(500)])}),this.userRoles=Le.map(m=>({value:m,label:m==="Admin"?"Administrator":"Common User"})),this.countries=Ve,this.passwordInputType="password"}ngOnInit(){this.startPasswordMatchValidation()}closeDialog(){this.resetForm(),this.dialogRef.close()}addUser(){this.form.markAllAsTouched(),!this.form.invalid&&(this.dialogRef.close({user:{email:this.form.get("email").value,role:this.form.get("role").value},profile:{firstName:this.form.get("firstName").value,lastName:this.form.get("lastName").value,phoneNumber:this.form.get("phoneNumber").value,country:this.form.get("country").value.name,address:this.form.get("address").value},password:this.form.get("password").value}),this.resetForm())}resetForm(){this.form.reset()}togglePasswordVisibility(){this.passwordInputType=this.passwordInputType==="password"?"text":"password"}passwordMatchValidation(){this.form.get("password").value!==this.form.get("confirmPassword").value&&this.form.get("confirmPassword").setErrors({passwordMatch:!0})}startPasswordMatchValidation(){this.form.get("confirmPassword").valueChanges.subscribe(()=>this.passwordMatchValidation())}selectCountry(){let p=this.form.get("country")?.value?.areaCode;p&&this.form.get("phoneNumber")?.setValue(`(+${p}) `)}};t.\u0275fac=function(m){return new(m||t)(v(L))},t.\u0275cmp=U({type:t,selectors:[["app-create-user-dialog"]],decls:93,vars:32,consts:[["mat-dialog-title","",1,"mat-dialog-title"],["svgIcon","account",1,"mr-2"],[1,"flex-spacer"],["mat-icon-button","",3,"click"],["svgIcon","close"],[1,"py-2","form",3,"formGroup"],["appearance","outline","color","primary",1,"mat-form-field"],["matInput","","type","text","placeholder","Email...","formControlName","email"],["matPrefix","","svgIcon","email"],["class","mat-error",4,"ngIf"],["formControlName","role"],[3,"value"],["matPrefix","","svgIcon","shield-account"],["matInput","","placeholder","Password...","formControlName","password",3,"type"],["matPrefix","","svgIcon","lock"],["mat-icon-button","","matSuffix","",3,"click"],[3,"svgIcon"],["matInput","","placeholder","Confirm Password...","formControlName","confirmPassword",3,"type"],["matPrefix","","svgIcon","lock-check"],["matInput","","type","text","placeholder","Nombre...","formControlName","firstName"],["matPrefix","","svgIcon","account-box"],["matInput","","type","text","placeholder","Last name...","formControlName","lastName"],["formControlName","country",3,"selectionChange"],["matPrefix","","svgIcon","flag"],["matInput","","type","text","placeholder","Select a country...","formControlName","phoneNumber","appPhoneNumber","",3,"readonly","country"],["matPrefix","","svgIcon","phone"],["appearance","outline","color","primary","id","address-field",1,"mat-form-field"],["matInput","","type","text","placeholder","Address...","formControlName","address","rows","3"],["matPrefix","","svgIcon","map-marker"],["align","end",1,"mat-dialog-actions"],["mat-button","","color","basic",3,"click"],["mat-flat-button","","color","primary",3,"click"],["svgIcon","plus-circle"],[1,"mat-error"],[1,"country-img",3,"src","alt"],[1,"country-name"]],template:function(m,i){if(m&1&&(o(0,"h2",0),c(1,"mat-icon",1),a(2," Create user "),c(3,"div",2),o(4,"button",3),g("click",function(){return i.closeDialog()}),c(5,"mat-icon",4),r()(),o(6,"mat-dialog-content")(7,"form",5)(8,"mat-form-field",6)(9,"mat-label"),a(10," Email "),r(),c(11,"input",7)(12,"mat-icon",8),f(13,Lt,2,0,"mat-error",9)(14,Ft,2,0,"mat-error",9)(15,Rt,2,0,"mat-error",9),r(),o(16,"mat-form-field",6)(17,"mat-label"),a(18," Role "),r(),o(19,"mat-select",10),k(20,Ot,2,2,"mat-option",11,At),r(),c(22,"mat-icon",12),f(23,jt,2,0,"mat-error",9),r(),o(24,"mat-form-field",6)(25,"mat-label"),a(26," Password "),r(),c(27,"input",13)(28,"mat-icon",14),o(29,"button",15),g("click",function(){return i.togglePasswordVisibility()}),c(30,"mat-icon",16),r(),f(31,$t,2,0,"mat-error",9)(32,Gt,2,0,"mat-error",9)(33,zt,2,0,"mat-error",9)(34,Bt,2,0,"mat-error",9)(35,Ht,2,0,"mat-error",9)(36,Qt,2,0,"mat-error",9)(37,Wt,2,0,"mat-error",9),r(),o(38,"mat-form-field",6)(39,"mat-label"),a(40," Confirm Password "),r(),c(41,"input",17)(42,"mat-icon",18),o(43,"button",15),g("click",function(){return i.togglePasswordVisibility()}),c(44,"mat-icon",16),r(),f(45,Jt,2,0,"mat-error",9)(46,Zt,2,0,"mat-error",9),r(),o(47,"mat-form-field",6)(48,"mat-label"),a(49," Name "),r(),c(50,"input",19)(51,"mat-icon",20),f(52,Kt,2,0,"mat-error",9)(53,Xt,2,0,"mat-error",9)(54,Yt,2,0,"mat-error",9),r(),o(55,"mat-form-field",6)(56,"mat-label"),a(57," Last name "),r(),c(58,"input",21)(59,"mat-icon",20),f(60,er,2,0,"mat-error",9)(61,tr,2,0,"mat-error",9)(62,rr,2,0,"mat-error",9),r(),o(63,"mat-form-field",6)(64,"mat-label"),a(65," Country "),r(),o(66,"mat-select",22),g("selectionChange",function(){return i.selectCountry()}),k(67,ir,4,5,"mat-option",11,Vt),r(),c(69,"mat-icon",23),f(70,or,2,0,"mat-error",9),r(),o(71,"mat-form-field",6)(72,"mat-label"),a(73," Phone number "),r(),c(74,"input",24)(75,"mat-icon",25),f(76,ar,2,0,"mat-error",9)(77,nr,2,0,"mat-error",9),r(),o(78,"mat-form-field",26)(79,"mat-label"),a(80," Address "),r(),c(81,"textarea",27)(82,"mat-icon",28),f(83,lr,2,0,"mat-error",9)(84,mr,2,0,"mat-error",9)(85,sr,2,0,"mat-error",9),r()()(),o(86,"mat-dialog-actions",29)(87,"button",30),g("click",function(){return i.closeDialog()}),c(88,"mat-icon",4),a(89," Cancel "),r(),o(90,"button",31),g("click",function(){return i.addUser()}),c(91,"mat-icon",32),a(92," Create "),r()()),m&2){let s,_,C,y,j,$,G,z,B,H,Q,W,J,Z,K,X,Y,ee,te,re,ie,oe,ae,ne,le,me,se;n(7),l("formGroup",i.form),n(6),l("ngIf",(s=i.form.get("email"))==null?null:s.hasError("required")),n(),l("ngIf",(_=i.form.get("email"))==null?null:_.hasError("email")),n(),l("ngIf",(C=i.form.get("email"))==null?null:C.hasError("maxLength")),n(5),q(i.userRoles),n(3),l("ngIf",(y=i.form.get("role"))==null?null:y.hasError("required")),n(4),l("type",i.passwordInputType),n(3),l("svgIcon",i.passwordInputType==="password"?"eye":"eye-off"),n(),l("ngIf",(j=i.form.get("password"))==null?null:j.hasError("required")),n(),l("ngIf",($=i.form.get("password"))==null?null:$.hasError("minlength")),n(),l("ngIf",(G=i.form.get("password"))==null?null:G.hasError("maxlength")),n(),l("ngIf",(z=i.form.get("password"))==null?null:z.hasError("hasNumber")),n(),l("ngIf",(B=i.form.get("password"))==null?null:B.hasError("hasUppercase")),n(),l("ngIf",(H=i.form.get("password"))==null?null:H.hasError("hasLowercase")),n(),l("ngIf",(Q=i.form.get("password"))==null?null:Q.hasError("hasSpecialCharacter")),n(4),l("type",i.passwordInputType),n(3),l("svgIcon",i.passwordInputType==="password"?"eye":"eye-off"),n(),l("ngIf",(W=i.form.get("confirmPassword"))==null?null:W.hasError("required")),n(),l("ngIf",(J=i.form.get("confirmPassword"))==null?null:J.hasError("passwordMatch")),n(6),l("ngIf",(Z=i.form.get("firstName"))==null?null:Z.hasError("required")),n(),l("ngIf",(K=i.form.get("firstName"))==null?null:K.hasError("minlength")),n(),l("ngIf",(X=i.form.get("firstName"))==null?null:X.hasError("maxlength")),n(6),l("ngIf",(Y=i.form.get("lastName"))==null?null:Y.hasError("required")),n(),l("ngIf",(ee=i.form.get("lastName"))==null?null:ee.hasError("minlength")),n(),l("ngIf",(te=i.form.get("lastName"))==null?null:te.hasError("maxlength")),n(5),q(i.countries),n(3),l("ngIf",(re=i.form.get("country"))==null?null:re.hasError("required")),n(4),l("readonly",!((ie=i.form.get("country"))!=null&&ie.value))("country",(oe=i.form.get("country"))==null?null:oe.value),n(2),l("ngIf",(ae=i.form.get("phoneNumber"))==null?null:ae.hasError("required")),n(),l("ngIf",(ne=i.form.get("phoneNumber"))==null?null:ne.hasError("phoneNumberWithAreaCode")),n(6),l("ngIf",(le=i.form.get("address"))==null?null:le.hasError("required")),n(),l("ngIf",(me=i.form.get("address"))==null?null:me.hasError("minlength")),n(),l("ngIf",(se=i.form.get("address"))==null?null:se.hasError("maxlength"))}},dependencies:[V,Ee,ve,we,xe,be,Ue,D,T,N,F,O,R,Ne,Ie,Se,De,Te,Pe,Me,ge,Ae],styles:[".form[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;column-gap:16px}@media (width < 640px){.form[_ngcontent-%COMP%]{grid-template-columns:1fr}}.country-img[_ngcontent-%COMP%]{position:absolute}.country-name[_ngcontent-%COMP%]{margin-left:30px}@media (width >= 640px){#address-field[_ngcontent-%COMP%]{grid-column:1/span 2}}"]});let e=t;return e})();var pr=(e,t)=>t.value,cr=(e,t)=>t.code;function dr(e,t){e&1&&(o(0,"mat-error",33),a(1," Email is required "),r())}function ur(e,t){e&1&&(o(0,"mat-error",33),a(1," The email is not valid "),r())}function fr(e,t){e&1&&(o(0,"mat-error",33),a(1," The email must have a maximum of 320 characters "),r())}function _r(e,t){if(e&1&&(o(0,"mat-option",11),a(1),r()),e&2){let d=t.$implicit;l("value",d.value),n(),E(d.label)}}function gr(e,t){e&1&&(o(0,"mat-error",33),a(1," The role is required "),r())}function hr(e,t){if(e&1){let d=A();o(0,"button",34),g("click",function(){I(d);let m=w();return S(m.togglePasswordVisibility())}),c(1,"mat-icon",35),r()}if(e&2){let d=w();n(),l("svgIcon",d.passwordInputType==="password"?"eye":"eye-off")}}function Cr(e,t){e&1&&(o(0,"mat-error",33),a(1," Password is required "),r())}function vr(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must be at least 10 characters "),r())}function wr(e,t){e&1&&(o(0,"mat-error",33),a(1," The password must have a maximum of 100 characters "),r())}function xr(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one number "),r())}function yr(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one uppercase letter "),r())}function Er(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one lowercase letter "),r())}function br(e,t){e&1&&(o(0,"mat-error",33),a(1," Password must have at least one special character "),r())}function Ur(e,t){if(e&1){let d=A();o(0,"button",34),g("click",function(){I(d);let m=w();return S(m.togglePasswordVisibility())}),c(1,"mat-icon",35),r()}if(e&2){let d=w();n(),l("svgIcon",d.passwordInputType==="password"?"eye":"eye-off")}}function Ir(e,t){e&1&&(o(0,"mat-error",33),a(1," Confirmation is required "),r())}function Sr(e,t){e&1&&(o(0,"mat-error",33),a(1," Confirmation must match password "),r())}function Dr(e,t){e&1&&(o(0,"mat-error",33),a(1," The name is required "),r())}function Tr(e,t){e&1&&(o(0,"mat-error",33),a(1," The name must be at least 3 characters "),r())}function Nr(e,t){e&1&&(o(0,"mat-error",33),a(1," Name must be less than 50 characters "),r())}function Pr(e,t){e&1&&(o(0,"mat-error",33),a(1," Last name is required "),r())}function Mr(e,t){e&1&&(o(0,"mat-error",33),a(1," Last name must be at least 3 characters "),r())}function kr(e,t){e&1&&(o(0,"mat-error",33),a(1," Last name must be less than 50 characters "),r())}function qr(e,t){if(e&1&&(o(0,"mat-option",11),c(1,"img",36),o(2,"span",37),a(3),r()()),e&2){let d=t.$implicit;l("value",d),n(),_e("src","https://flagsapi.com/",d.code,"/flat/24.png",fe),l("alt",d.code),n(2),b(" ",d.name," ")}}function Ar(e,t){e&1&&(o(0,"mat-error",33),a(1," The country is required "),r())}function Vr(e,t){e&1&&(o(0,"mat-error",33),a(1," Phone number is required "),r())}function Lr(e,t){e&1&&(o(0,"mat-error",33),a(1," The phone number is invalid "),r())}function Fr(e,t){e&1&&(o(0,"mat-error",33),a(1," Address is required "),r())}function Rr(e,t){e&1&&(o(0,"mat-error",33),a(1," Address must be at least 10 characters "),r())}function Or(e,t){e&1&&(o(0,"mat-error",33),a(1," Address must be less than 500 characters "),r())}var It=(()=>{let t=class t{constructor(p,m){this.dialogRef=p,this.data=m,this.form=new ye({email:new h("",[u.required,u.email,u.maxLength(320)]),updatePassword:new h(!1),password:new h("",[u.required,u.minLength(10),u.maxLength(100),x.hasLowercase(),x.hasUppercase(),x.hasNumber(),x.hasSpecialCharacter()]),confirmPassword:new h("",[u.required]),role:new h("User",[u.required]),firstName:new h("",[u.required,u.minLength(3),u.maxLength(50)]),lastName:new h("",[u.required,u.minLength(3),u.maxLength(50)]),country:new h(null,[u.required]),phoneNumber:new h("",[u.required,x.phoneNumberWithAreaCode()]),address:new h("",[u.required,u.minLength(10),u.maxLength(500)])}),this.userRoles=Le.map(i=>({value:i,label:i==="Admin"?"Administrator":"Common User"})),this.countries=Ve,this.passwordInputType="password"}ngOnInit(){this.form.patchValue({email:this.data.user.email,role:this.data.user.role,firstName:this.data.profile.firstName,lastName:this.data.profile.lastName,country:this.countries.find(p=>p.name===this.data.profile.country),phoneNumber:this.data.profile.phoneNumber,address:this.data.profile.address}),this.togglePasswordUpdate(),this.startPasswordMatchValidation()}closeDialog(){this.resetForm(),this.dialogRef.close()}editUser(){this.form.markAllAsTouched(),!this.form.invalid&&(this.dialogRef.close({user:{email:this.form.get("email").value,role:this.form.get("role").value},profile:{firstName:this.form.get("firstName").value,lastName:this.form.get("lastName").value,phoneNumber:this.form.get("phoneNumber").value,country:this.form.get("country").value.name,address:this.form.get("address").value},password:this.form.get("updatePassword").value?this.form.get("password").value:void 0}),this.resetForm())}resetForm(){this.form.reset()}togglePasswordUpdate(){let p=this.form.get("updatePassword").value;this.form.get("password").reset(),this.form.get("confirmPassword").reset(),p?(this.form.get("password").enable(),this.form.get("confirmPassword").enable()):(this.form.get("password").disable(),this.form.get("confirmPassword").disable())}togglePasswordVisibility(){this.passwordInputType=this.passwordInputType==="password"?"text":"password"}passwordMatchValidation(){this.form.get("password").value!==this.form.get("confirmPassword").value&&this.form.get("confirmPassword").setErrors({passwordMatch:!0})}startPasswordMatchValidation(){this.form.get("confirmPassword").valueChanges.subscribe(()=>this.passwordMatchValidation())}selectCountry(){let p=this.form.get("country")?.value?.areaCode;p&&this.form.get("phoneNumber")?.setValue(`(+${p}) `)}};t.\u0275fac=function(m){return new(m||t)(v(L),v(he))},t.\u0275cmp=U({type:t,selectors:[["app-update-user-dialog"]],decls:93,vars:32,consts:[["mat-dialog-title","",1,"mat-dialog-title"],["svgIcon","account",1,"mr-2"],[1,"flex-spacer"],["mat-icon-button","",3,"click"],["svgIcon","close"],[1,"py-2","form",3,"formGroup"],["appearance","outline","color","primary",1,"mat-form-field"],["matInput","","type","text","placeholder","Email...","formControlName","email"],["matPrefix","","svgIcon","email"],["class","mat-error",4,"ngIf"],["formControlName","role"],[3,"value"],["matPrefix","","svgIcon","shield-account"],["color","primary","formControlName","updatePassword","id","password-toggle",1,"mb-3",3,"change"],["matInput","","placeholder","Password...","formControlName","password",3,"type"],["matPrefix","","svgIcon","lock"],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["matInput","","placeholder","Confirmaci\xF3n...","formControlName","confirmPassword",3,"type"],["matPrefix","","svgIcon","lock-check"],["matInput","","type","text","placeholder","Nombre...","formControlName","firstName"],["matPrefix","","svgIcon","account-box"],["matInput","","type","text","placeholder","Apellido...","formControlName","lastName"],["formControlName","country",3,"selectionChange"],["matPrefix","","svgIcon","flag"],["matInput","","type","text","placeholder","Seleccione un pa\xEDs...","formControlName","phoneNumber","appPhoneNumber","",3,"readonly","country"],["matPrefix","","svgIcon","phone"],["appearance","outline","color","primary","id","address-field",1,"mat-form-field"],["matInput","","type","text","placeholder","Address...","formControlName","address","rows","3"],["matPrefix","","svgIcon","map-marker"],["align","end",1,"mat-dialog-actions"],["mat-button","","color","basic",3,"click"],["mat-flat-button","","color","primary",3,"click"],["svgIcon","pencil"],[1,"mat-error"],["mat-icon-button","","matSuffix","",3,"click"],[3,"svgIcon"],[1,"country-img",3,"src","alt"],[1,"country-name"]],template:function(m,i){if(m&1&&(o(0,"h2",0),c(1,"mat-icon",1),a(2," Edit user "),c(3,"div",2),o(4,"button",3),g("click",function(){return i.closeDialog()}),c(5,"mat-icon",4),r()(),o(6,"mat-dialog-content")(7,"form",5)(8,"mat-form-field",6)(9,"mat-label"),a(10," Email "),r(),c(11,"input",7)(12,"mat-icon",8),f(13,dr,2,0,"mat-error",9)(14,ur,2,0,"mat-error",9)(15,fr,2,0,"mat-error",9),r(),o(16,"mat-form-field",6)(17,"mat-label"),a(18," Role "),r(),o(19,"mat-select",10),k(20,_r,2,2,"mat-option",11,pr),r(),c(22,"mat-icon",12),f(23,gr,2,0,"mat-error",9),r(),o(24,"mat-slide-toggle",13),g("change",function(){return i.togglePasswordUpdate()}),a(25," Do you want to update the user's password? "),r(),o(26,"mat-form-field",6)(27,"mat-label"),a(28," Password "),r(),c(29,"input",14)(30,"mat-icon",15),f(31,hr,2,1,"button",16)(32,Cr,2,0,"mat-error",9)(33,vr,2,0,"mat-error",9)(34,wr,2,0,"mat-error",9)(35,xr,2,0,"mat-error",9)(36,yr,2,0,"mat-error",9)(37,Er,2,0,"mat-error",9)(38,br,2,0,"mat-error",9),r(),o(39,"mat-form-field",6)(40,"mat-label"),a(41," Confirm Password "),r(),c(42,"input",17)(43,"mat-icon",18),f(44,Ur,2,1,"button",16)(45,Ir,2,0,"mat-error",9)(46,Sr,2,0,"mat-error",9),r(),o(47,"mat-form-field",6)(48,"mat-label"),a(49," Name "),r(),c(50,"input",19)(51,"mat-icon",20),f(52,Dr,2,0,"mat-error",9)(53,Tr,2,0,"mat-error",9)(54,Nr,2,0,"mat-error",9),r(),o(55,"mat-form-field",6)(56,"mat-label"),a(57," Last name "),r(),c(58,"input",21)(59,"mat-icon",20),f(60,Pr,2,0,"mat-error",9)(61,Mr,2,0,"mat-error",9)(62,kr,2,0,"mat-error",9),r(),o(63,"mat-form-field",6)(64,"mat-label"),a(65," Country "),r(),o(66,"mat-select",22),g("selectionChange",function(){return i.selectCountry()}),k(67,qr,4,5,"mat-option",11,cr),r(),c(69,"mat-icon",23),f(70,Ar,2,0,"mat-error",9),r(),o(71,"mat-form-field",6)(72,"mat-label"),a(73," Phone number "),r(),c(74,"input",24)(75,"mat-icon",25),f(76,Vr,2,0,"mat-error",9)(77,Lr,2,0,"mat-error",9),r(),o(78,"mat-form-field",26)(79,"mat-label"),a(80," Address "),r(),c(81,"textarea",27)(82,"mat-icon",28),f(83,Fr,2,0,"mat-error",9)(84,Rr,2,0,"mat-error",9)(85,Or,2,0,"mat-error",9),r()()(),o(86,"mat-dialog-actions",29)(87,"button",30),g("click",function(){return i.closeDialog()}),c(88,"mat-icon",4),a(89," Cancel "),r(),o(90,"button",31),g("click",function(){return i.editUser()}),c(91,"mat-icon",32),a(92," Edit "),r()()),m&2){let s,_,C,y,j,$,G,z,B,H,Q,W,J,Z,K,X,Y,ee,te,re,ie,oe,ae,ne,le,me,se;n(7),l("formGroup",i.form),n(6),l("ngIf",(s=i.form.get("email"))==null?null:s.hasError("required")),n(),l("ngIf",(_=i.form.get("email"))==null?null:_.hasError("email")),n(),l("ngIf",(C=i.form.get("email"))==null?null:C.hasError("maxLength")),n(5),q(i.userRoles),n(3),l("ngIf",(y=i.form.get("role"))==null?null:y.hasError("required")),n(6),l("type",i.passwordInputType),n(2),l("ngIf",i.form.get("updatePassword").value),n(),l("ngIf",(j=i.form.get("password"))==null?null:j.hasError("required")),n(),l("ngIf",($=i.form.get("password"))==null?null:$.hasError("minlength")),n(),l("ngIf",(G=i.form.get("password"))==null?null:G.hasError("maxlength")),n(),l("ngIf",(z=i.form.get("password"))==null?null:z.hasError("hasNumber")),n(),l("ngIf",(B=i.form.get("password"))==null?null:B.hasError("hasUppercase")),n(),l("ngIf",(H=i.form.get("password"))==null?null:H.hasError("hasLowercase")),n(),l("ngIf",(Q=i.form.get("password"))==null?null:Q.hasError("hasSpecialCharacter")),n(4),l("type",i.passwordInputType),n(2),l("ngIf",i.form.get("updatePassword").value),n(),l("ngIf",(W=i.form.get("confirmPassword"))==null?null:W.hasError("required")),n(),l("ngIf",(J=i.form.get("confirmPassword"))==null?null:J.hasError("passwordMatch")),n(6),l("ngIf",(Z=i.form.get("firstName"))==null?null:Z.hasError("required")),n(),l("ngIf",(K=i.form.get("firstName"))==null?null:K.hasError("minlength")),n(),l("ngIf",(X=i.form.get("firstName"))==null?null:X.hasError("maxlength")),n(6),l("ngIf",(Y=i.form.get("lastName"))==null?null:Y.hasError("required")),n(),l("ngIf",(ee=i.form.get("lastName"))==null?null:ee.hasError("minlength")),n(),l("ngIf",(te=i.form.get("lastName"))==null?null:te.hasError("maxlength")),n(5),q(i.countries),n(3),l("ngIf",(re=i.form.get("country"))==null?null:re.hasError("required")),n(4),l("readonly",!((ie=i.form.get("country"))!=null&&ie.value))("country",(oe=i.form.get("country"))==null?null:oe.value),n(2),l("ngIf",(ae=i.form.get("phoneNumber"))==null?null:ae.hasError("required")),n(),l("ngIf",(ne=i.form.get("phoneNumber"))==null?null:ne.hasError("phoneNumberWithAreaCode")),n(6),l("ngIf",(le=i.form.get("address"))==null?null:le.hasError("required")),n(),l("ngIf",(me=i.form.get("address"))==null?null:me.hasError("minlength")),n(),l("ngIf",(se=i.form.get("address"))==null?null:se.hasError("maxlength"))}},dependencies:[V,Ee,ve,we,xe,be,Ue,D,T,N,F,O,R,Ne,Ie,Se,De,Te,Pe,Me,ge,gt,Ae],styles:[".form[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;column-gap:16px}@media (width < 640px){.form[_ngcontent-%COMP%]{grid-template-columns:1fr}}.country-img[_ngcontent-%COMP%]{position:absolute}.country-name[_ngcontent-%COMP%]{margin-left:30px}#password-toggle[_ngcontent-%COMP%]{display:flex;justify-content:center}@media (width >= 640px){#address-field[_ngcontent-%COMP%], #password-toggle[_ngcontent-%COMP%]{grid-column:1/span 2}}"]});let e=t;return e})();var jr=()=>[10,15,20];function $r(e,t){e&1&&(o(0,"th",21),a(1,"First name, Last name"),r())}function Gr(e,t){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let d=t.$implicit;n(),We(" ",d.profile.firstName," ",d.profile.lastName," ")}}function zr(e,t){e&1&&(o(0,"th",21),a(1,"Email"),r())}function Br(e,t){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let d=t.$implicit;n(),E(d.user.email)}}function Hr(e,t){e&1&&(o(0,"th",21),a(1,"Role"),r())}function Qr(e,t){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let d=t.$implicit;n(),E(d.user.role)}}function Wr(e,t){e&1&&(o(0,"th",21),a(1,"Phone"),r())}function Jr(e,t){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let d=t.$implicit;n(),b(" ",d.profile.phoneNumber," ")}}function Zr(e,t){e&1&&(o(0,"th",21),a(1,"Country"),r())}function Kr(e,t){if(e&1&&(o(0,"td",22),a(1),r()),e&2){let d=t.$implicit;n(),b(" ",d.profile.country," ")}}function Xr(e,t){e&1&&(o(0,"th",21),a(1,"Actions"),r())}function Yr(e,t){if(e&1){let d=A();o(0,"td",22)(1,"button",23),g("click",function(){let m=I(d).$implicit,i=w(2);return S(i.editUser(m))}),o(2,"mat-icon"),a(3,"edit"),r()(),o(4,"button",24),g("click",function(){let m=I(d).$implicit,i=w(2);return S(i.deleteUser(m))}),o(5,"mat-icon"),a(6,"delete"),r()()()}}function ei(e,t){e&1&&c(0,"tr",25)}function ti(e,t){e&1&&c(0,"tr",26)}function ri(e,t){if(e&1){let d=A();o(0,"main")(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title",3),c(4,"mat-icon",4),a(5," Manage users "),r()(),o(6,"mat-card-content")(7,"div",5)(8,"button",6),g("click",function(){I(d);let m=w();return S(m.addUser())}),c(9,"mat-icon",7),a(10," Add user "),r()(),o(11,"div",8)(12,"table",9),P(13,10),f(14,$r,2,0,"th",11)(15,Gr,2,2,"td",12),M(),P(16,13),f(17,zr,2,0,"th",11)(18,Br,2,1,"td",12),M(),P(19,14),f(20,Hr,2,0,"th",11)(21,Qr,2,1,"td",12),M(),P(22,15),f(23,Wr,2,0,"th",11)(24,Jr,2,1,"td",12),M(),P(25,16),f(26,Zr,2,0,"th",11)(27,Kr,2,1,"td",12),M(),P(28,17),f(29,Xr,2,0,"th",11)(30,Yr,7,0,"td",12),M(),f(31,ei,1,0,"tr",18)(32,ti,1,0,"tr",19),r()(),o(33,"mat-paginator",20),g("page",function(m){I(d);let i=w();return S(i.selectPage(m))}),r()()()()}if(e&2){let d=w();n(12),l("dataSource",d.tableUsers),n(19),l("matHeaderRowDef",d.displayedColumns),n(),l("matRowDefColumns",d.displayedColumns),n(),l("pageSizeOptions",Je(5,jr))("length",d.users.length)}}function ii(e,t){if(e&1&&c(0,"app-loading-view",27),e&2){let d=w();l("state",d.viewState)}}var St=(()=>{let t=class t{constructor(p,m,i,s,_){this.usersService=p,this.usersMapper=m,this.peopleService=i,this.peopleMapper=s,this.dialog=_,this.displayedColumns=["name","email","phone","country","role","actions"],this.viewState="loading",this.pageSize=10,this.pageIndex=0}ngOnInit(){this.getUsers()}getUsers(){this.viewState="loading",Qe([this.usersService.getAllUsers(),this.peopleService.getAllPeople()]).subscribe({next:([p,m])=>{this.users=this.usersMapper.mapGetAllUsersResponseDtoToModel(p),this.profiles=this.peopleMapper.mapGetAllPeopleResponseDtoToModel(m),this.tableUsers=this.users.map(i=>{let s=this.profiles.find(_=>_.id===i.id);return{user:i,profile:s}}),this.renderUserPagination(),this.viewState="ready"},error:p=>{this.viewState="error"}})}addUser(){this.dialog.open(Ut,{width:Ce.lg}).afterClosed().subscribe(m=>{m&&(this.loadingDialog.open(),this.usersService.createUser({email:m.user.email,password:m.password,role:m.user.role}).subscribe({next:()=>Be(this,null,function*(){let s=(yield He(this.usersService.getAllUsers())).users.find(_=>_.email===m.user.email);if(!s){this.errorDialog.open("An error occurred while creating the user","The created user could not be found"),this.loadingDialog.close();return}this.peopleService.updatePerson(m.profile,s.id).pipe(ce(()=>this.loadingDialog.close())).subscribe({next:()=>{this.getUsers()},error:_=>{this.errorDialog.open("An error occurred while updating the profile",_.message)}})}),error:i=>{this.errorDialog.open("An error occurred while creating the user",i.message),this.loadingDialog.close()}}))})}editUser(p){let m=this.dialog.open(It,{width:Ce.lg,data:{user:p.user,profile:p.profile}}),i=p.user.id;m.afterClosed().subscribe(s=>{s&&(this.loadingDialog.open(),this.usersService.updateUser({email:s.user.email,role:s.user.role,password:s.password},i).subscribe({next:()=>{this.peopleService.updatePerson(s.profile,i).pipe(ce(()=>this.loadingDialog.close())).subscribe({next:()=>{let _=this.users.find(y=>y.id===i),C=this.profiles.find(y=>y.id===i);_.email=s.user.email,_.role=s.user.role,C.firstName=s.profile.firstName,C.lastName=s.profile.lastName,C.phoneNumber=s.profile.phoneNumber,C.country=s.profile.country,C.address=s.profile.address},error:_=>{this.errorDialog.open("An error occurred while updating the profile",_.message),this.loadingDialog.close()}})},error:_=>{this.errorDialog.open("An error occurred while updating the user",_.message),this.loadingDialog.close()}}))})}deleteUser(p){this.dialog.open(Et,{width:Ce.md,data:{user:p.user,profile:p.profile}}).afterClosed().subscribe(i=>{i&&(this.loadingDialog.open(),this.usersService.deleteUser(i.user.id).pipe(ce(()=>this.loadingDialog.close())).subscribe({next:()=>{this.users=this.users.filter(s=>s.id!==i.user.id),this.profiles=this.profiles.filter(s=>s.id!==i.user.id),this.renderUserPagination()},error:s=>{this.errorDialog.open("An error occurred while deleting the product",s.message)}}))})}renderUserPagination(){let p=this.pageIndex*this.pageSize,m=p+this.pageSize,i=this.users.slice(p,m),s=i.map(_=>this.profiles.find(C=>C.id===_.id));this.tableUsers=i.map((_,C)=>({user:_,profile:s[C]}))}selectPage(p){this.pageSize=p.pageSize,this.pageIndex=p.pageIndex}};t.\u0275fac=function(m){return new(m||t)(v(vt),v(wt),v(xt),v(yt),v(Ke))},t.\u0275cmp=U({type:t,selectors:[["app-users"]],viewQuery:function(m,i){if(m&1&&(Fe(ke,5),Fe(qe,5)),m&2){let s;Re(s=Oe())&&(i.loadingDialog=s.first),Re(s=Oe())&&(i.errorDialog=s.first)}},decls:5,vars:2,consts:[[4,"ngIf"],["view","usuarios",3,"state",4,"ngIf"],[1,"mx-4","mt-5"],[1,"inline-flex-aligned"],["svgIcon","account-group",1,"ml-3","mr-2"],[1,"flex-aligned","justify-end","mt-3"],["mat-raised-button","","color","primary",3,"click"],["svgIcon","plus-circle"],["id","table-responsive"],["mat-table","",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","email"],["matColumnDef","role"],["matColumnDef","phone"],["matColumnDef","country"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",1,"mt-3",3,"page","pageSizeOptions","length"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],["view","usuarios",3,"state"]],template:function(m,i){m&1&&(c(0,"app-navbar"),f(1,ri,34,6,"main",0)(2,ii,1,1,"app-loading-view",1),c(3,"app-error-dialog")(4,"app-loading-dialog")),m&2&&(n(),l("ngIf",i.viewState==="ready"),n(),l("ngIf",i.viewState!=="ready"))},dependencies:[V,D,T,N,Ye,tt,rt,et,at,lt,ct,mt,nt,dt,st,pt,ut,ft,_t,it,ot,ke,qe],styles:["mat-card[_ngcontent-%COMP%]{border-radius:25px;box-shadow:0 0 12px #0003}mat-card-content[_ngcontent-%COMP%]   #table-responsive[_ngcontent-%COMP%]{width:100%;overflow-x:scroll}.mat-column-actions[_ngcontent-%COMP%]{text-align:center;width:150px;white-space:nowrap}"]});let e=t;return e})();var oi=[{path:"",component:St}],Dt=(()=>{let t=class t{};t.\u0275fac=function(m){return new(m||t)},t.\u0275mod=ue({type:t}),t.\u0275inj=de({imports:[je.forChild(oi),je]});let e=t;return e})();var ro=(()=>{let t=class t{};t.\u0275fac=function(m){return new(m||t)},t.\u0275mod=ue({type:t}),t.\u0275inj=de({imports:[Ze,Xe,Dt,ht,Ct]});let e=t;return e})();export{ro as UsersModule};
